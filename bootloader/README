NOTE: The files contained in this directory are provided "as is".
There is no warranty of fitness for any purpose or support provided
by Wind River for u-boot.
---

1. Update u-boot:
=================

<1> Program a new U-Boot to QSPI flash memory
=============================================
By default, an existing U-Boot is run in bank 0 after the system is powered on or
after a hard reset is performed. To flash U-Boot to the alternate bank, first
switch to bank 0 by performing a hard reset or by typing reset. Then use the
following commands to flash a new U-Boot into the alternate bank and then switch
to that alternate bank where the new U-Boot is flashed:

=>tftp 82000000 <u-boot_file_name>.bin
=>sf probe 0:1
=>sf erase 100000 +$filesize
=>sf write 82000000 100000 $filesize
=>cpld reset altbank

NOTE:
 - You can use the sf probe 0:0 command to program U-Boot to the current bank.
 - The U-Boot image generated from code needs to be swapped. Yocto also generates the
   swapped U-Boot image, which is programmed to the QSPI flash memory.

<2> Program a new U-Boot to SD card
===================================
To program U-Boot, first boot the board to U-Boot. Next, load the new U-Boot SD boot
image to RAM by downloading it via TFTP and then copying it to the SD card using the
blk offset 0x8 command. Then, run the following commands at the U-Boot prompt to program
the U-Boot to the SD card and reset to SD boot:

=>tftp 82000000 <u-boot_file_name>.bin
=>mmc erase 8 0x800
=>mmc write 0x82000000 8 0x800
=>cpld reset sd

Program the image to the SD card in Linux using the following command:
dd if=<u-boot_file_name>.bin of=/dev/sdx bs=512 seek=8

2. Update RCW:
=============
In the LS1046ARDB, you can program a new RCW to the QSPI flash memory. 
To program a new RCW, first switch to QSPI bank 0 by either performing
a hard reset or typing reset. Next, load the new RCW to RAM by downloading
it via TFTP and then copying it to flash offset 0x0, which is the offset
address of RCW in the QSPI flash memory. Then, run the following commands
at the U-Boot prompt to program the RCW to the QSPI flash memory and reset
to the alternate bank:

=>tftp 82000000 <rcw_file_name>.bin
=>sf probe 0:1
=>sf erase 0 +$filesize
=>sf write 82000000 0 $filesize;
=>cpld reset altbank

NOTE:
 - You can use the sf probe 0:0 command to program the RCW to the current bank.

Images:
=======
ls1046ardb/u-boot-emmc-2016.09+fslgit-r0.bin
ls1046ardb/u-boot-qspi-2016.09+fslgit-r0.bin
ls1046ardb/u-boot-sdcard-2016.09+fslgit-r0.bin

3. Program a new FMan microcode
===============================

<1> Program a new microcode to QSPI flash memory
To program a new microcode, first switch to QSPI bank 0 by either performing
a hard reset or typing cpld reset. Next, load the new microcode to RAM by
downloading it via TFTP and then writing it to flash offset 0x300000, which
is the offset of microcode in the QSPI flash memory. Then, run the following
commands at the U-Boot prompt to program the microcode to the boot device:
=>tftp 83000000 <ucode_file_name>.bin
=>sf probe 0:1
=>sf erase 300000 +$filesize
=>sf write 83000000 300000 $filesize

NOTE:
 - You can use the sf probe 0:0 to program the microcode to the current bank.

<2> Program a new microcode to SD card
======================================
Run the following command to program a new microcode to the SD card:

=>tftp 83000000 <ucode_file_name>.bin
=>mmc write 83000000 820 50

4. Note
=======
 - If you want to debug u-boot, it is better to burn u-boot image into SD
   card to avoid breaking image in QSPI flash or eMMC
 - You can get u-boot source code from git://git.freescale.com/ppc/sdk/u-boot.git
 - You can get FMan microcode from nxp SDK 2.0-1703
